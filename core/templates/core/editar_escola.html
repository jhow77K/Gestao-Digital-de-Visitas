<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editar Escola</title>
  </head>
  <body>
    <h1>Editar Escola</h1>

    <form method="post">
      {% csrf_token %}
      <label for="nome">Nome:</label>
      <input
        type="text"
        id="nome"
        name="nome"
        value="{{ escola.nome }}"
        required
      /><br />

      <label for="responsavel">Responsável:</label>
      <input
        type="text"
        id="responsavel"
        name="responsavel"
        value="{{ escola.responsavel }}"
        required
      /><br />

      <label for="endereco">Endereço:</label>
      <input
        type="text"
        id="endereco"
        name="endereco"
        value="{{ escola.endereco }}"
        required
      /><br />

      <label for="bairro">Bairro:</label>
      <input
        type="text"
        id="bairro"
        name="bairro"
        value="{{ escola.bairro }}"
        required
      /><br />

      <label for="telefone">Telefone:</label>
      <input
        type="text"
        id="telefone"
        name="telefone"
        value="{{ escola.telefone }}"
        required
      /><br />

      <label for="email">Email:</label>
      <input
        type="email"
        id="email"
        name="email"
        value="{{ escola.email }}"
        required
      /><br />

      <label for="cnpj">CNPJ:</label>
      <input
        type="text"
        id="cnpj"
        name="cnpj"
        value="{{ escola.cnpj }}"
        required
      /><br />

      <button type="submit">Salvar Alterações</button>
    </form>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Máscara para telefone
        const telefoneInput = document.getElementById("telefone");
        if (telefoneInput) {
          telefoneInput.addEventListener("input", function () {
            let value = telefoneInput.value.replace(/\D/g, "");
            if (value.length > 11) value = value.slice(0, 11);

            let formatted = "";
            if (value.length > 0) {
              formatted += "(" + value.substring(0, 2);
            }
            if (value.length >= 3) {
              formatted += ") ";
              if (value.length === 9) {
                formatted +=
                  value.substring(2, 6) + "-" + value.substring(6, 9);
              } else if (value.length === 10) {
                formatted +=
                  value.substring(2, 6) + "-" + value.substring(6, 10);
              } else if (value.length === 11) {
                formatted +=
                  value.substring(2, 7) + "-" + value.substring(7, 11);
              } else if (value.length > 2) {
                formatted += value.substring(2, value.length);
              }
            }
            telefoneInput.value = formatted;
          });

          telefoneInput.addEventListener("keypress", function (e) {
            const char = String.fromCharCode(e.which);
            if (!/[0-9\-]/.test(char)) {
              e.preventDefault();
            }
          });
        }

        // Máscara para CNPJ
        const cnpjInput = document.getElementById("cnpj");
        if (cnpjInput) {
          cnpjInput.addEventListener("input", function () {
            let value = cnpjInput.value.replace(/\D/g, "");
            if (value.length > 14) value = value.slice(0, 14);

            let formatted = "";
            if (value.length > 0) {
              formatted += value.substring(0, 2);
            }
            if (value.length >= 3) {
              formatted += "." + value.substring(2, 5);
            }
            if (value.length >= 6) {
              formatted += "." + value.substring(5, 8);
            }
            if (value.length >= 9) {
              formatted += "/" + value.substring(8, 12);
            }
            if (value.length >= 13) {
              formatted += "-" + value.substring(12, 14);
            }
            cnpjInput.value = formatted;
          });

          cnpjInput.addEventListener("keypress", function (e) {
            const char = String.fromCharCode(e.which);
            if (!/[0-9]/.test(char)) {
              e.preventDefault();
            }
          });
        }

        // Máscara para email: impede espaços e caracteres inválidos
        const emailInput = document.getElementById("email");
        if (emailInput) {
          emailInput.addEventListener("input", function () {
            emailInput.value = emailInput.value.replace(/\s/g, "");
          });

          emailInput.addEventListener("keypress", function (e) {
            const char = String.fromCharCode(e.which);
            if (!/[a-zA-Z0-9@._\-]/.test(char)) {
              e.preventDefault();
            }
          });
        }
      });
    </script>
  </body>
</html>
